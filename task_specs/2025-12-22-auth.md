## Functional requirements:
- we need to know who the user is so that we can perform some basic authorization as well as record who modifies what

## Thoughts:
- it probably makes sense to have a separate authentication service which will handle the many types of authentication that this server will require
    - this includes basic jwt auth
    - federated auth using platform native authentication from discord etc
    - generation of guest links on documents
- for now just use the users service as the authentication service
    - this is a simpler solution that is optimized for shipping faster and quickly seeing visible results
- for now just use HSA encryption so that we don't have to worry about a mechanism for distributing public keys. All the services will be deployed at the same time and this is my personal project so it is fine if we use a symmetric encryption approach
    - if security is important, we will use something else

## Technical requirements:
- ensure that we are hashing passwords correctly:
    - https://www.alexedwards.net/blog/how-to-hash-and-verify-passwords-with-argon2-in-go
- [ ] add an rpc to the users service which validates a password
    - example code for creating tokens:
        - https://pkg.go.dev/github.com/golang-jwt/jwt/v5#section-readme
    - [x] update the user service proto to include a route for checking if a password is correct
    - [x] implement the validate password rpc method
        - [x] add a query to the user repo which reads hashed passwords from the user database
        - [x] add password hashing and hash comparison logic to the service layer so that the sent password can be validated against the hashed password
        - [x] add the application level parsing logic to the server layer of the user service
    - [ ] confirm that the existing implementation follows password hashing best practices
    - [x] update the user service client to have a method for the IsValid route
- [ ] add a route to the api gateway which takes the credentials and then calls the credential validation rpc on the users service
    - resource for adding authentication information to the api spec:
        - https://swagger.io/docs/specification/v3_0/authentication/
    - resource for implementing the authentication spec using oapi-codegen:
        - https://github.com/oapi-codegen/oapi-codegen/tree/main/examples/authenticated-api
    - [x] add the authentication schema to the openapi spec 
    - [ ] implement the route in the api gateway service layer:
        - [ ] call the user service to validate credentials
        - [ ] use a function defined in a package to generate a token 
- [ ] implement authentication middleware on all of the api gateway routes except for the login route
    - [ ] add a middleware that parses and validates the token