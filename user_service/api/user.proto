syntax = "proto3";

option go_package = "github.com/townsag/reed/users_service/api";
import "google/protobuf/empty.proto";
package api;

service UserService {
    rpc GetUser (GetUserRequest) returns (UserReply) {}
    rpc CreateUser (CreateUserRequest) returns (CreateUserReply) {}
    rpc DeactivateUser (DeactivateUserRequest) returns (google.protobuf.Empty) {}
    // rpc LoginUser (LoginUserRequest) returns (LoginUserReply) {}
    rpc ChangeUserPassword (ChangeUserPasswordRequest) returns (google.protobuf.Empty) {}
    rpc ValidatePassword (ValidatePasswordRequest) returns (ValidatePasswordReply) {}
}

message User {
    string user_id = 1;
    string user_name = 2;
    string email = 3;
    int32 max_documents = 4;
    // these are implicit field types
    // I am taking that to mean semantically that they will always be set by the server 
}

message GetUserRequest {
    string user_id = 1;
}

message UserReply {
    User user = 1;
}

message CreateUserRequest {
    string user_name = 1;
    string user_email = 2;
    string password = 3;
    optional int32 max_documents = 4;
}

message CreateUserReply {
    string user_id = 2;
}

message DeactivateUserRequest {
    string user_id = 1;
}

// message LoginUserRequest {
//     string user_name = 1;
//     string password = 2;
// }

// message LoginUserReply {
//     string a
// }

message ChangeUserPasswordRequest {
    string user_id = 1;
    string old_password = 2;
    string new_password = 3;
}

message ValidatePasswordRequest {
    string user_name = 1;
    string user_password = 2;
}

message ValidatePasswordReply {
    optional string user_id = 1;
    bool is_valid = 2;
    // in the future we can add other information here like scopes or limits that may 
    // be useful to include in a generated token
}